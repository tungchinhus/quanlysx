ssl_protocols TLSv1.3;
root /home/nginx/web/public;
location / {
  add_header X-Frame-Options "Deny";
  add_header X-Content-Type-Options nosniff;
  add_header Referrer-Policy strict-origin-when-cross-origin;
  expires 1M;
  add_header Cache-Control "no-transform, no-cache, must-revalidate, proxy-revalidate";
  add_header Pragma 'no-cache';
  add_header Set-Cookie "HttpOnly; Secure;";
  add_header Content-Security-Policy "default-src 'self' api.emmuat.asia.manulife.com https://sea-emt-dev-api.ap.manulife.com api.emtdev.asia.manulife.com sea-emm-sit-api.ap.manulife.com api.emmsit.asia.manulife.com api.emmuat.asia.manulife.com sea-emm-prd-api.ap.manulife.com gateway.zscloud.net tracking.fingereach.com manulife.demdex.net assets.adobedtm.com js-agent.newrelic.com dpm.demdex.net connect.facebook.net manulifefinancial.tt.omtrdc.net bam-cell.nr-data.net bam.nr-data.net cm.g.doubleclick.net api.emmuat.asia.manulife.com cm.everesttech.net google-analytics.com www.google-analytics.com trk.hot-mob.com fonts.gstatic.com; script-src 'self' api.emmuat.asia.manulife.com https://sea-emt-dev-api.ap.manulife.com sea-emm-sit-api.ap.manulife.com api.emmsit.asia.manulife.com api.emmuat.asia.manulife.com sea-emm-prd-api.ap.manulife.com gateway.zscloud.net 'unsafe-inline' tracking.fingereach.com manulife.demdex.net assets.adobedtm.com js-agent.newrelic.com dpm.demdex.net connect.facebook.net manulifefinancial.tt.omtrdc.net bam-cell.nr-data.net bam.nr-data.net cm.g.doubleclick.net api.emmuat.asia.manulife.com cm.everesttech.net google-analytics.com www.google-analytics.com trk.hot-mob.com; style-src 'self' api.emmuat.asia.manulife.com sea-emt-dev-api.ap.manulife.com sea-emm-sit-api.ap.manulife.com api.emmuat.asia.manulife.com sea-emm-prd-api.ap.manulife.com gateway.zscloud.net 'unsafe-inline' tracking.fingereach.com manulife.demdex.net assets.adobedtm.com js-agent.newrelic.com dpm.demdex.net connect.facebook.net manulifefinancial.tt.omtrdc.net bam-cell.nr-data.net bam.nr-data.net cm.g.doubleclick.net api.emmuat.asia.manulife.com cm.everesttech.net google-analytics.com www.google-analytics.com trk.hot-mob.com fonts.gstatic.com; img-src 'self' data:;";

  gzip on;
  gzip_types text/plain text/css application/xml application/javascript application/octet-stream application/json image/jpeg image/png image/svg+xml image/webp font/woff font/woff2 text/xml image/x-icon;
  gzip_proxied no-cache no-store private expired auth;

  index index.html index.htm;
  try_files $uri $uri/ /index.html;
}

# location /quanlysx/ {
#   proxy_pass http://localhost:8080/;
#   proxy_http_version 1.1;
#   proxy_redirect off;
# }

# location /ext/vn-payment-bff-service {
#   rewrite ^/ext/vn-payment-bff-service/(.*) /$1 break;
#   proxy_pass http://svc-vn-online-payment-bff.ns-vnm-bank-system:8080;
#   proxy_http_version 1.1;
#   proxy_redirect off;
# }

# location /ext/vn-payment-bff-token-service {
#   rewrite ^/ext/vn-payment-bff-token-service/(.*) /$1 break;
#   proxy_pass http://svc-vn-online-payment-bff.ns-vnm-bank-system:8080;
#   proxy_http_version 1.1;
#   proxy_redirect off;
# }

# momo, vnPay redirect
location /complete {
  proxy_pass http://svc-vn-online-payment-bff.ns-vnm-bank-system:8080/v1/payment/redirect;
  proxy_http_version 1.1;
  proxy_redirect off;
}

# cyber-source redirect
location /cybersource-complete {
  proxy_pass http://svc-vn-online-payment-bff.ns-vnm-bank-system:8080/v1/payment/cyber-source/redirect;
  proxy_http_version 1.1;
  proxy_redirect off;
}

# cyber-source callback
location /callback {
  proxy_pass http://svc-vn-online-payment-bff.ns-vnm-bank-system:8080/v1/payment/callback;
  proxy_http_version 1.1;
  proxy_redirect off;
  #proxy_cookie_path / "/; secure; HttpOnly; SameSite=None";
}

# momo callback
location /momo-callback {
  proxy_pass http://svc-vn-online-payment-bff.ns-vnm-bank-system:8080/v1/payment/momo/callback;
  proxy_http_version 1.1;
  proxy_redirect off;
  #proxy_cookie_path / "/; secure; HttpOnly; SameSite=None";
}

# vnpay callback
location /vnpay-callback {
  proxy_pass http://svc-vn-online-payment-bff.ns-vnm-bank-system:8080/v1/payment/vnpay/callback;
  proxy_http_version 1.1;
  proxy_redirect off;
  #proxy_cookie_path / "/; secure; HttpOnly; SameSite=None";
}

location /cancelled {
  proxy_pass http://svc-vn-online-payment-bff.ns-vnm-bank-system:8080/cancelled;
  proxy_http_version 1.1;
  proxy_redirect off;
  #proxy_cookie_path / "/; secure; HttpOnly; SameSite=None";
}

location /redirect-complete {
proxy_pass http://svc-vn-online-payment-bff.ns-vnm-bank-system:8080/v1/payment/redirect;
proxy_http_version 1.1;
proxy_redirect off;
#proxy_cookie_path / "/; secure; HttpOnly; SameSite=None";
}