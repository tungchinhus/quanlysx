<div class="main-container">
  <mat-card class="form-card">
    <mat-card-title class="text-center">{{ title }}</mat-card-title>
    <mat-card-content>
      <form [formGroup]="windingForm" (ngSubmit)="onSubmit()">
        <!-- Nhóm 1 -->
        <div class="fixed-fields-row">
          <div class="fixed-field-group">
            <span class="fixed-label">Công suất:</span>
            <mat-form-field appearance="standard" class="fixed-input">
              <input matInput formControlName="congSuat" placeholder="Nhập công suất">
            </mat-form-field>
            <span class="unit-label">KVA</span>
          </div>

          <div class="fixed-field-group">
            <span class="fixed-label">TBKT:</span>
            <mat-form-field appearance="standard" class="fixed-input">
              <input matInput formControlName="TBKT" placeholder="Nhập BKT">
            </mat-form-field>
          </div>
        </div>

        <!-- Nhóm 2 -->
        <div class="fixed-fields-row">
          <div class="fixed-field-group">
            <span class="fixed-label">Điện áp:</span>
            <mat-form-field appearance="standard" class="fixed-input">
              <input matInput formControlName="dienAp" placeholder="Nhập điện áp">
            </mat-form-field>
            <span class="unit-label">KV</span>
          </div>

          <div class="fixed-field-group">
            <span class="fixed-label">Số bối dây:</span>
            <mat-form-field appearance="standard" class="fixed-input">
              <input matInput formControlName="soBoiDay" type="number" placeholder="Nhập số bối dây">
            </mat-form-field>
          </div>
        </div>
        <hr class="section-separator" />
        <div class="form-row">
          <!-- Ngày gia công -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Ngày gia công</mat-label>
            <input matInput [matDatepicker]="pickerNgayGiaCong" formControlName="ngayGiaCong">
            <mat-datepicker-toggle matSuffix [for]="pickerNgayGiaCong"></mat-datepicker-toggle>
            <mat-datepicker #pickerNgayGiaCong></mat-datepicker>
            <mat-error *ngIf="windingForm.get('ngayGiaCong')?.hasError('required') && windingForm.get('ngayGiaCong')?.touched">
              Ngày gia công là bắt buộc.
            </mat-error>
          </mat-form-field>

          <!-- Người gia công -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Người gia công</mat-label>
            <mat-select formControlName="nguoiGiaCong">
              <mat-option value="">Chọn người gia công</mat-option>
              <mat-option *ngFor="let nguoi of nguoiGiaCongOptions" [value]="nguoi">
                {{ nguoi }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <!-- Ký hiệu BV -->
        <div class="form-row-full">
          <mat-form-field appearance="outline" class="form-field-full">
            <mat-label>Ký hiệu BV</mat-label>
            <input matInput formControlName="kyHieuBV" placeholder="Nhập ký hiệu BV">
            <mat-error *ngIf="windingForm.get('kyHieuBV')?.hasError('required') && windingForm.get('kyHieuBV')?.touched">
              Ký hiệu BV là bắt buộc.
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <!-- Quy cách dây -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Quy cách dây</mat-label>
            <input matInput formControlName="quyCachDay" placeholder="Nhập quy cách dây">
            <mat-error *ngIf="windingForm.get('quyCachDay')?.hasError('required') && windingForm.get('quyCachDay')?.touched">
              Quy cách dây là bắt buộc.
            </mat-error>
          </mat-form-field>

          <!-- Số sợi dây -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Số sợi dây</mat-label>
            <input matInput type="number" formControlName="soSoiDay" placeholder="Nhập số sợi dây">
            <mat-error *ngIf="windingForm.get('soSoiDay')?.hasError('required') && windingForm.get('soSoiDay')?.touched">
              Số sợi dây là bắt buộc.
            </mat-error>
            <mat-error *ngIf="windingForm.get('soSoiDay')?.hasError('min') && windingForm.get('soSoiDay')?.touched">
              Số sợi dây phải lớn hơn 0.
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <!-- Ngày sản xuất -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Ngày sản xuất</mat-label>
            <input matInput [matDatepicker]="pickerNgaySanXuat" formControlName="ngaySanXuat">
            <mat-datepicker-toggle matSuffix [for]="pickerNgaySanXuat"></mat-datepicker-toggle>
            <mat-datepicker #pickerNgaySanXuat></mat-datepicker>
            <mat-error *ngIf="windingForm.get('ngaySanXuat')?.hasError('required') && windingForm.get('ngaySanXuat')?.touched">
              Ngày sản xuất là bắt buộc.
            </mat-error>
          </mat-form-field>

          <!-- Nhà sản xuất -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Nhà sản xuất</mat-label>
            <input matInput formControlName="nhaSanXuat" placeholder="Nhập nhà sản xuất">
            <mat-error *ngIf="windingForm.get('nhaSanXuat')?.hasError('required') && windingForm.get('nhaSanXuat')?.touched">
              Nhà sản xuất là bắt buộc.
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row form-row-3-cols">
          <!-- Chu vi khuôn -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Chu vi khuôn</mat-label>
            <input matInput type="number" formControlName="chuViKhuon" placeholder="Nhập chu vi khuôn">
            <mat-error *ngIf="windingForm.get('chuViKhuon')?.hasError('required') && windingForm.get('chuViKhuon')?.touched">
              Chu vi khuôn là bắt buộc.
            </mat-error>
            <mat-error *ngIf="windingForm.get('chuViKhuon')?.hasError('min') && windingForm.get('chuViKhuon')?.touched">
              Chu vi khuôn phải lớn hơn hoặc bằng 0.
            </mat-error>
          </mat-form-field>

          <!-- KT bụng bd trước -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>KT bụng bd trước</mat-label>
            <input matInput type="number" formControlName="ktBungBdTruoc" placeholder="Nhập KT bụng bd trước">
          </mat-form-field>

          <!-- Bụng bd sau -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Bụng bd sau</mat-label>
            <input matInput type="number" formControlName="bungBdSau" placeholder="Nhập bụng bd sau">
            <mat-error *ngIf="windingForm.get('bungBdSau')?.hasError('required') && windingForm.get('bungBdSau')?.touched">
              Bụng bd sau là bắt buộc.
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <!-- Chiều quấn dây -->
          <div class="form-field">
            <mat-label class="block-label">Chiều quấn dây</mat-label>
            <mat-radio-group aria-label="Chiều quấn dây" formControlName="chieuQuanDay" class="radio-group">
              <mat-radio-button value="trai">Trái</mat-radio-button>
              <mat-radio-button value="phai">Phải</mat-radio-button>
            </mat-radio-group>
            <mat-error *ngIf="windingForm.get('chieuQuanDay')?.hasError('required') && windingForm.get('chieuQuanDay')?.touched">
              Chiều quấn dây là bắt buộc.
            </mat-error>
          </div>

          <!-- Máy quấn dây -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Máy quấn dây: QD</mat-label>
            <input matInput formControlName="mayQuanDay" placeholder="Nhập máy quấn dây">
            <mat-error *ngIf="windingForm.get('mayQuanDay')?.hasError('required') && windingForm.get('mayQuanDay')?.touched">
              Máy quấn dây là bắt buộc.
            </mat-error>
          </mat-form-field>
        </div>

        <mat-card class="section-card">
          <mat-card-title>QTD hạ</mat-card-title>
          <mat-card-content>
            <!-- Xung quanh, dày (mm) -->
            <div class="form-group-label">Xung quanh, dày (mm):</div>
            <div class="form-row form-row-4-cols">
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>2mm</mat-label>
                <input matInput type="number" formControlName="xqDay2" placeholder="Nhập số">
              </mat-form-field>
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>3mm</mat-label>
                <input matInput type="number" formControlName="xqDay3" placeholder="Nhập số">
              </mat-form-field>
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>4mm</mat-label>
                <input matInput type="number" formControlName="xqDay4" placeholder="Nhập số">
              </mat-form-field>
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>6mm</mat-label>
                <input matInput type="number" formControlName="xqDay6" placeholder="Nhập số">
              </mat-form-field>
            </div>

            <!-- Hai đầu, dày (mm) -->
            <div class="form-group-label">Hai đầu, dày (mm):</div>
            <div class="form-row form-row-4-cols">
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>2mm</mat-label>
                <input matInput type="number" formControlName="hdDay2" placeholder="Nhập số">
              </mat-form-field>
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>3mm</mat-label>
                <input matInput type="number" formControlName="hdDay3" placeholder="Nhập số">
              </mat-form-field>
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>4mm</mat-label>
                <input matInput type="number" formControlName="hdDay4" placeholder="Nhập số">
              </mat-form-field>
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>6mm</mat-label>
                <input matInput type="number" formControlName="hdDay6" placeholder="Nhập số">
              </mat-form-field>
            </div>
          </mat-card-content>
        </mat-card>

        <mat-card class="section-card">
          <mat-card-content>
            <!-- KT bd Hạ trong BV -->
            <div class="form-group-label">KT bd Hạ trong BV:</div>
            <div class="form-row form-row-bv">
              <span class="label-text">Bảng vẽ 123</span>
              <span class="label-text">TT</span>
              <mat-form-field appearance="outline" class="form-field">
                <input matInput formControlName="ktBdHaTrongBv1" placeholder="Nhập giá trị">
              </mat-form-field>
              <mat-form-field appearance="outline" class="form-field">
                <input matInput formControlName="ktBdHaTrongBv2" placeholder="Nhập giá trị">
              </mat-form-field>
              <mat-form-field appearance="outline" class="form-field">
                <input matInput formControlName="ktBdHaTrongBv3" placeholder="Nhập giá trị">
              </mat-form-field>
            </div>

            <!-- Chu vi bd Hạ trong 1 - 3p -->
            <div class="form-row form-row-flex-label">
              <mat-label class="block-label-inline">Chu vi bd Hạ trong 1 - 3p:</mat-label>
              <div class="form-row form-row-3-cols flex-grow">
                <mat-form-field appearance="outline" class="form-field">
                  <input matInput formControlName="cvBdHa1p" placeholder="Pha 1">
                </mat-form-field>
                <mat-form-field appearance="outline" class="form-field">
                  <input matInput formControlName="cvBdHa2p" placeholder="Pha 2">
                </mat-form-field>
                <mat-form-field appearance="outline" class="form-field">
                  <input matInput formControlName="cvBdHa3p" placeholder="Pha 3">
                </mat-form-field>
              </div>
            </div>

            <!-- KT bd Hạ ngoài BV -->
            <div class="form-group-label">KT bd Hạ ngoài BV:</div>
            <div class="form-row form-row-bv-outside">
              <span class="label-text">Bảng vẽ 123</span>
              <span class="label-text">TT</span>
              <mat-form-field appearance="outline" class="form-field">
                <input matInput formControlName="ktBdHaNgoaiBv1" placeholder="Nhập giá trị">
              </mat-form-field>
              <mat-form-field appearance="outline" class="form-field">
                <input matInput formControlName="ktBdHaNgoaiBv2" placeholder="Nhập giá trị">
              </mat-form-field>
              <mat-form-field appearance="outline" class="form-field">
                <input matInput formControlName="ktBdHaNgoaiBv3" placeholder="Nhập giá trị">
              </mat-form-field>
              <mat-form-field appearance="outline" class="form-field">
                <input matInput formControlName="ktBdHaNgoaiBv4" placeholder="Nhập giá trị">
              </mat-form-field>
            </div>

            <!-- Điện trở hạ -->
            <div class="form-group-label">Điện trở hạ:</div>
            <div class="form-row form-row-3-cols">
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Ra</mat-label>
                <input matInput type="number" formControlName="dienTroRa" placeholder="Nhập Ra">
              </mat-form-field>
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Rb</mat-label>
                <input matInput type="number" formControlName="dienTroRb" placeholder="Nhập Rb">
              </mat-form-field>
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Rc</mat-label>
                <input matInput type="number" formControlName="dienTroRc" placeholder="Nhập Rc">
              </mat-form-field>
            </div>

            <!-- Độ lệch điện trở giữa các pha -->
            <div class="form-row form-row-flex-label">
              <mat-label class="block-label-inline">Độ lệch điện trở giữa các pha:</mat-label>
              <mat-form-field appearance="outline" class="form-field flex-grow">
                <input matInput type="number" formControlName="doLechDienTro" placeholder="Nhập độ lệch">
              </mat-form-field>
              <span class="label-text-small">(TC: &lt;=2%)</span>
            </div>
          </mat-card-content>
        </mat-card>

      </form>
    </mat-card-content>
  </mat-card>
</div>